server:
  port: 8080
  servlet:
    context-path: /api
    encoding:
      charset: UTF-8
      enabled: true
      force: true

spring:
  # 数据库配置
  datasource:
    # 本地开发环境
    # url: jdbc:mysql://localhost:3306/login_demo?useUnicode=true&characterEncoding=utf-8&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai
    # username: logindemo
    # password: qq7816288
    # 云服务器环境
    url: jdbc:mysql://120.77.92.36:3306/login_demo?useUnicode=true&characterEncoding=utf-8&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai
    username: logindemo
    password: Srcb@2025
    driver-class-name: com.mysql.cj.jdbc.Driver
    # HikariCP 连接池配置 (Spring Boot 2.x 及以上默认使用HikariCP)[6,8](@ref)
    hikari:
      # 连接池最大连接数，默认10[6,8](@ref)
      maximum-pool-size: 10
      # 空闲连接存活最大时间（毫秒），默认600000（10分钟）[6](@ref)
      idle-timeout: 180000
      # 连接最大生命周期（毫秒），默认1800000（30分钟）[6](@ref)
      max-lifetime: 1800000
      # 数据库连接超时时间（毫秒），默认30000（30秒）[6](@ref)
      connection-timeout: 30000
      # 用于验证连接是否有效的SQL查询，例如 SELECT 1[6](@ref)
      connection-test-query: SELECT 1

  # Redis配置
  redis:
    host: 127.0.0.1
    port: 6379
    database: 0
    timeout: 10000ms
    # password: Srcb@2025  # 本地开发环境注释掉密码配置
    lettuce:
      pool:
        enabled: false  # 本地开发环境关闭连接池，避免连接问题
    connect-timeout: 5000

  # 安全配置
  security:
    cors:
      allowed-origins: "*"
      allowed-methods: "*"
      allowed-headers: "*"

# MyBatis-Plus配置
mybatis-plus:
  mapper-locations: classpath*:/mapper/**/*.xml
  type-aliases-package: com.logindemo.model
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl

# JWT配置
jwt:
  secret: your-secret-key-change-in-production-must-be-at-least-64-chars-long-for-hs512-algorithm-security
  expiration: 3600000
  refresh-expiration: 86400000

# 登录失败限制配置
login:
  max-attempts: 5
  lock-duration: 300

# 验证码配置
captcha:
  expire-time: 300  # 验证码过期时间（秒），默认5分钟
  require-threshold: 2  # 需要验证码的失败次数阈值

# 日志配置
logging:
  level:
    root: INFO
    com.logindemo: DEBUG
  file:
    name: logs/application.log
  charset:
    console: UTF-8
    file: UTF-8
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n'
    file: '%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n'
  config: classpath:logback-spring.xml