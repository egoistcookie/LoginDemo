server:
  port: 8080
  servlet:
    context-path: /api
    encoding:
      charset: UTF-8
      enabled: true
      force: true
  tomcat:
    # 限制HTTP头大小，防止恶意请求
    max-http-header-size: 8192
    # 限制请求体大小
    max-swallow-size: 2MB
    # 连接超时设置
    connection-timeout: 20000
    # keep-alive超时
    keep-alive-timeout: 20000
    # 处理无效请求的配置
    reject-illegal-header: true
    # 线程池配置
    threads:
      max: 200
      min-spare: 10
  error:
    # 生产环境不包含堆栈跟踪
    include-stacktrace: never
    # 生产环境不包含错误消息详情
    include-message: never

spring:
  # 数据库配置 - 生产环境请修改为实际数据库地址
  datasource:
    url: jdbc:mysql://120.77.92.36:3306/login_demo?useUnicode=true&characterEncoding=utf-8&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai
    username: logindemo
    password: Srcb@2025
    driver-class-name: com.mysql.cj.jdbc.Driver
    # 连接池配置
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  # Redis配置 - 生产环境请修改为实际Redis地址和密码
  redis:
    host: localhost
    port: 6379
    database: 0
    timeout: 10000ms
    password: Srcb@2025
    lettuce:
      pool:
        enabled: true
        max-active: 20
        max-idle: 10
        min-idle: 5
        max-wait: 5000ms
    connect-timeout: 5000

  # 安全配置 - 生产环境请限制允许的域名
  security:
    cors:
      allowed-origins: 
        - https://your-domain.com
        - https://www.your-domain.com
      allowed-methods: 
        - GET
        - POST
        - PUT
        - DELETE
        - OPTIONS
      allowed-headers: "*"
      allow-credentials: true

# MyBatis-Plus配置
mybatis-plus:
  mapper-locations: classpath*:/mapper/**/*.xml
  type-aliases-package: com.logindemo.model
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl

# JWT配置 - 生产环境必须修改为强密码（至少64字符）
# 注意：生产环境和开发环境的secret必须保持一致，否则token会失效
jwt:
  secret: your-secret-key-change-in-production-must-be-at-least-64-chars-long-for-hs512-algorithm-security
  expiration: 3600000  # 1小时（毫秒）
  refresh-expiration: 86400000  # 24小时（毫秒）

# 登录失败限制配置
login:
  max-attempts: 5  # 最大尝试次数
  lock-duration: 300  # 锁定时间（秒）

# 验证码配置
captcha:
  expire-time: 300  # 验证码过期时间（秒），默认5分钟
  require-threshold: 3  # 需要验证码的失败次数阈值

# 日志配置 - 生产环境建议使用 INFO 级别
logging:
  level:
    root: INFO
    com.logindemo: INFO
    # 降低Tomcat相关日志级别，减少无效请求的错误日志
    org.apache.coyote: ERROR
    org.apache.tomcat: ERROR
    org.apache.catalina: ERROR
  file:
    name: /opt/logindemo/logs/application.log
  charset:
    console: UTF-8
    file: UTF-8
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n'
    file: '%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n'
  config: classpath:logback-spring.xml
  # 日志轮转配置（在 logback-spring.xml 中配置）

# Swagger配置 - 生产环境建议禁用或限制访问
springdoc:
  api-docs:
    enabled: false  # 生产环境建议禁用
  swagger-ui:
    enabled: false  # 生产环境建议禁用

